<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Week 9: Data Persitance and MongoDB | MAD9124</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Full-stack: API Development">
    
    <link rel="preload" href="/s2024/assets/css/0.styles.70738741.css" as="style"><link rel="preload" href="/s2024/assets/js/app.40d35fb0.js" as="script"><link rel="preload" href="/s2024/assets/js/2.d13f26af.js" as="script"><link rel="preload" href="/s2024/assets/js/1.f6f71081.js" as="script"><link rel="preload" href="/s2024/assets/js/26.de8d994d.js" as="script"><link rel="preload" href="/s2024/assets/js/32.baab7363.js" as="script"><link rel="prefetch" href="/s2024/assets/js/10.700b6097.js"><link rel="prefetch" href="/s2024/assets/js/11.ed8a0934.js"><link rel="prefetch" href="/s2024/assets/js/12.9b4b523d.js"><link rel="prefetch" href="/s2024/assets/js/13.07dd1a9d.js"><link rel="prefetch" href="/s2024/assets/js/14.b96c24af.js"><link rel="prefetch" href="/s2024/assets/js/15.b144383e.js"><link rel="prefetch" href="/s2024/assets/js/16.d16dea2a.js"><link rel="prefetch" href="/s2024/assets/js/17.b4e1a4e8.js"><link rel="prefetch" href="/s2024/assets/js/18.1f2ac466.js"><link rel="prefetch" href="/s2024/assets/js/19.e668708c.js"><link rel="prefetch" href="/s2024/assets/js/20.4f30b3de.js"><link rel="prefetch" href="/s2024/assets/js/21.248f91f3.js"><link rel="prefetch" href="/s2024/assets/js/22.29f49c1a.js"><link rel="prefetch" href="/s2024/assets/js/23.b8ac89c9.js"><link rel="prefetch" href="/s2024/assets/js/24.e2934475.js"><link rel="prefetch" href="/s2024/assets/js/25.fce0b0a1.js"><link rel="prefetch" href="/s2024/assets/js/27.c7ef8247.js"><link rel="prefetch" href="/s2024/assets/js/28.75604c91.js"><link rel="prefetch" href="/s2024/assets/js/29.1b506275.js"><link rel="prefetch" href="/s2024/assets/js/3.8c4cc701.js"><link rel="prefetch" href="/s2024/assets/js/30.787c7c10.js"><link rel="prefetch" href="/s2024/assets/js/31.e47a0c3f.js"><link rel="prefetch" href="/s2024/assets/js/33.aa620044.js"><link rel="prefetch" href="/s2024/assets/js/34.81206c0b.js"><link rel="prefetch" href="/s2024/assets/js/35.d62ca566.js"><link rel="prefetch" href="/s2024/assets/js/36.1835e393.js"><link rel="prefetch" href="/s2024/assets/js/37.5098b7b5.js"><link rel="prefetch" href="/s2024/assets/js/38.3ddeba96.js"><link rel="prefetch" href="/s2024/assets/js/39.3f5b8ef9.js"><link rel="prefetch" href="/s2024/assets/js/4.a03d1287.js"><link rel="prefetch" href="/s2024/assets/js/40.b63f2a79.js"><link rel="prefetch" href="/s2024/assets/js/41.5cb461bc.js"><link rel="prefetch" href="/s2024/assets/js/42.fcb0df3f.js"><link rel="prefetch" href="/s2024/assets/js/43.3a92d7d8.js"><link rel="prefetch" href="/s2024/assets/js/44.5c466f1c.js"><link rel="prefetch" href="/s2024/assets/js/45.c7c3dc1a.js"><link rel="prefetch" href="/s2024/assets/js/46.286df3e7.js"><link rel="prefetch" href="/s2024/assets/js/47.8363bb83.js"><link rel="prefetch" href="/s2024/assets/js/48.56c3e93e.js"><link rel="prefetch" href="/s2024/assets/js/49.b0be2d4e.js"><link rel="prefetch" href="/s2024/assets/js/5.ed6c1368.js"><link rel="prefetch" href="/s2024/assets/js/50.b89e2a53.js"><link rel="prefetch" href="/s2024/assets/js/51.7249e197.js"><link rel="prefetch" href="/s2024/assets/js/52.87fc5cdd.js"><link rel="prefetch" href="/s2024/assets/js/53.56f24714.js"><link rel="prefetch" href="/s2024/assets/js/54.fae6ee81.js"><link rel="prefetch" href="/s2024/assets/js/55.b1e6a4dd.js"><link rel="prefetch" href="/s2024/assets/js/56.eadf21bf.js"><link rel="prefetch" href="/s2024/assets/js/57.d912e614.js"><link rel="prefetch" href="/s2024/assets/js/6.45d9b7e6.js"><link rel="prefetch" href="/s2024/assets/js/7.017a2e0d.js"><link rel="prefetch" href="/s2024/assets/js/vendors~docsearch.38838867.js">
    <link rel="stylesheet" href="/s2024/assets/css/0.styles.70738741.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/s2024/" class="home-link router-link-active"><!----> <span class="site-name">MAD9124</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/s2024/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/s2024/modules/" class="nav-link router-link-active">
  Modules
</a></div><div class="nav-item"><a href="/s2024/deliverables/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/s2024/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/s2024/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/s2024/modules/" class="nav-link router-link-active">
  Modules
</a></div><div class="nav-item"><a href="/s2024/deliverables/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/s2024/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/s2024/modules/" aria-current="page" class="sidebar-link">Table of contents</a></li><li><a href="/s2024/modules/week01/" class="sidebar-link">Week 1: Introduction &amp; Review</a></li><li><a href="/s2024/modules/week02/" class="sidebar-link">Week 2: Node Modules &amp; Express</a></li><li><a href="/s2024/modules/week03/" class="sidebar-link">Week 3: APIs</a></li><li><a href="/s2024/modules/week04/" class="sidebar-link">Week 4: Project Structure, RESTful alternatives, and Postman</a></li><li><a href="/s2024/modules/week05/" class="sidebar-link">Week 5: Middleware</a></li><li><a href="/s2024/modules/week06/" class="sidebar-link">Week 6: Midterm Project</a></li><li><a href="/s2024/modules/week07/" class="sidebar-link">Week 7: API Integration &amp; Caching</a></li><li><a href="/s2024/modules/break-week/" class="sidebar-link">Break Week</a></li><li><a href="/s2024/modules/week09/" aria-current="page" class="active sidebar-link">Week 9: Data Persitance and MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#agenda" class="sidebar-link">Agenda</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#data-persistence" class="sidebar-link">Data persistence</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#databases" class="sidebar-link">Databases</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#relational-databases" class="sidebar-link">Relational Databases</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#document-databases" class="sidebar-link">Document Databases</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#hands-on-with-mongodb" class="sidebar-link">Hands on with MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#install-mongodb" class="sidebar-link">Install MongoDB</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#install-mongodb-compass" class="sidebar-link">Install MongoDB Compass</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#running-mongodb-locally" class="sidebar-link">Running MongoDB locally</a></li></ul></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#connect-to-mongodb-from-node-js" class="sidebar-link">Connect to MongoDB from Node.js</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#mongodb-vs-mongodb-atlas-what-are-the-differences" class="sidebar-link">MongoDB vs MongoDB Atlas: What are the differences?</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/week09/#exercise-set-up-mongodb" class="sidebar-link">Exercise: Set-up MongoDB</a></li></ul></li><li><a href="/s2024/modules/week10/" class="sidebar-link">Week 10: Object Data Modelling with Mongoose</a></li><li><a href="/s2024/modules/week11/" class="sidebar-link">Week 11: Data Santization, XSS and LoggingS</a></li><li><a href="/s2024/modules/week12/" class="sidebar-link">Week 12: Authentication With Passport</a></li><li><a href="/s2024/modules/week13/" class="sidebar-link">Week 13: Testing with Jest</a></li><li><a href="/s2024/modules/week14/" class="sidebar-link">Week 14: Preparing for Production</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1><span class="week">Week 9</span><br> <span class="title">Data Persitance and MongoDB</span></h1> <h2 id="agenda"><a href="#agenda" class="header-anchor">#</a> Agenda</h2> <ul><li>AMA (10 mins)</li> <li>Data persistence</li> <li>Difference between NoSQL DB and MySQL DB</li> <li>MongoDB on local</li> <li>Mongoose</li></ul> <h2 id="data-persistence"><a href="#data-persistence" class="header-anchor">#</a> Data persistence</h2> <p>Data persistence refers to the method of storing data in a permanent manner, even after the end of a session or the shutdown of the system. There are several ways to achieve data persistence in Node.js, including:</p> <ul><li><p>File System: Node.js provides a built-in module 'fs' to read and write files.</p></li> <li><p>Database: Popular databases used in Node.js include MySQL, PostgreSQL, MongoDB, etc.</p></li> <li><p>Cache: In-memory caching solutions like Redis or Memcached can be used for data persistence in Node.js.</p></li> <li><p>Object Serialization: Node.js provides the 'Object.serialize()' method to convert an object into a string representation, which can then be written to disk or a database.</p></li></ul> <p>Ultimately, the choice of data persistence method depends on the requirements of your application, such as scalability, security, performance, and data structure. All these information would become valuable in final-term Applied Projects.</p> <h2 id="databases"><a href="#databases" class="header-anchor">#</a> Databases</h2> <p>Most real world applications need to store structured data that reflects the state of the application and is selectively searchable, with appropriate authorization credentials. This is the job of a database.</p> <p>Traditionally databases systems have been based on a series of tables, like a spreadsheet, with the columns representing the properties on a record and each row containing the complete set of properties for that unique record.</p> <p>The cars data we have seen might be represented in a table like this:</p> <div class="language- extra-class"><pre class="language-text"><code>| id |  make | model | colour |
|---:|:-----:|:-----:|:------:|
|  1 | Tesla | S     | Black  |
|  2 | Tesla | 3     | Indigo |
|  3 | Tesla | X     | Brown  |
|  4 | Tesla | Y     | Silver |
</code></pre></div><h2 id="relational-databases"><a href="#relational-databases" class="header-anchor">#</a> Relational Databases</h2> <p>Relational databases are a type of database management system (DBMS) that use a relational model to organize data into one or more tables. The relationships between the tables are defined by common fields (keys) between them, which serve as unique identifiers for each record. The most widely used relational database management systems are <code>MySQL</code>, <code>PostgreSQL</code>, <code>Microsoft SQL Server</code>, <code>Oracle Database</code>, and <code>SQLite</code>.</p> <p>In a relational database, data is organized into rows and columns within tables, with each row representing a single record and each column representing a specific piece of information about the record. The relationships between tables are defined by the presence of common columns (keys) in multiple tables, which are used to link records together.</p> <p>Relational databases are well suited for applications that require complex data relationships and transactions, as well as for managing large amounts of structured data. They offer robust querying capabilities, enabling developers to retrieve and manipulate data in a variety of ways. However, they can be slower and more difficult to scale than other types of databases, such as NoSQL databases.</p> <h2 id="document-databases"><a href="#document-databases" class="header-anchor">#</a> Document Databases</h2> <p>Document databases are a type of NoSQL database management system (DBMS) that store data in semi-structured or unstructured documents. Each document represents a single record and contains all the information about that record, including both data and metadata. The documents are stored within collections, which are similar to tables in relational databases.</p> <p>In document databases, data is stored as JSON or BSON documents, which are flexible and allow for easy scaling and high performance. The schema-less nature of document databases means that documents can have different structures and fields, making it easier to add new data to the database without having to modify the existing schema.</p> <p>Document databases are well suited for applications that require high performance and scalability, as well as for handling complex, hierarchical data structures. Popular document databases include <code>MongoDB</code>, <code>CouchDB</code>, and <code>RavenDB</code>. However, document databases can be more difficult to query and may have limitations when it comes to complex transactions and data relationships.</p> <h2 id="hands-on-with-mongodb"><a href="#hands-on-with-mongodb" class="header-anchor">#</a> Hands on with MongoDB</h2> <h3 id="install-mongodb"><a href="#install-mongodb" class="header-anchor">#</a> Install MongoDB</h3> <p>There are several ways to get MongoDB running in your local development environment.</p> <ul><li>Download the runtime installer from the MongoDB website.</li> <li>Use Homebrew to install MongoDB.</li> <li>Use Docker and run it in a container.</li></ul> <p>For this course, we will using <strong>Homebrew to install MongoDB</strong>.</p> <p>Follow the instructions on the <a href="https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-os-x/" target="_blank" rel="noopener noreferrer">official website to install mongodb-community on macos<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="install-mongodb-compass"><a href="#install-mongodb-compass" class="header-anchor">#</a> Install MongoDB Compass</h3> <p>If you have worked with MySQL databases in the past you probably used a tool like phpMyAdmin, MySQL WorkBench or Sequel PRO to manage and query your databases. MongoDB has a similar tool call Compass. You can read all about its capabilities on at <a href="https://www.mongodb.com/try/download/compass#:~:text=MongoDB%20Compass%20Download" target="_blank" rel="noopener noreferrer">MongoDB.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p><strong>Make sure to select Platform depending on your MAC</strong></p> <p><img src="/s2024/assets/img/compass_1.4feda201.png" alt="Download Compass"></p> <p>With the correct version selected, click the big green download button, and then run the DMG installer (the downloaded file).</p> <h3 id="running-mongodb-locally"><a href="#running-mongodb-locally" class="header-anchor">#</a> Running MongoDB locally</h3> <p>Open the MongoDB Compass app and connect using this connection string</p> <p><code>mongodb://localhost:27017</code></p> <p><img src="/s2024/assets/img/compass_2.0ea0b52a.png" alt="Compass starting page"></p> <p>You should now see an active connection to the database engine that looks like this:</p> <p><img src="/s2024/assets/img/compass_3.0e1cec6c.png" alt="Compass Database"></p> <h2 id="connect-to-mongodb-from-node-js"><a href="#connect-to-mongodb-from-node-js" class="header-anchor">#</a> Connect to MongoDB from Node.js</h2> <p>All that set-up was so that we can persist application state in a database.</p> <p>In your Node.js apps, you will need to open a connection to the MongoDB database so that you can store and retrieve your resource objects (JSON documents). MongoDB provides a official NPM package which we can use to interact with the database. To install it in your project, simply run <code>npm i mongodb</code> in the terminal.</p> <p><strong>However ...</strong></p> <p>For this course we will instead be using a popular data modelling library called <a href="https://mongoosejs.com/" target="_blank" rel="noopener noreferrer">Mongoose<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="mongoose-quick-start"><a href="#mongoose-quick-start" class="header-anchor">#</a> Mongoose Quick Start</h4> <p><code>npm i mongoose</code></p> <p>Create a new file in your project folder called <code>mongooseTest.js</code>. We will give the mongoose.connect method the same connection string for our local MongoDB server that we used with Compass and then append the name of the database we want to connect to at the end. Let's call the database <code>test</code>. The full connection string should now be <code>mongodb://localhost:27017/test</code>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mongoose
  <span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;mongodb://localhost:27017/test&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Connected to mongodb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Error connecting to mongodb: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>Even though we have not previously created this <code>/test</code> database, MongoDB will automatically create it the first time we try to interact with it.</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Cat <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> kitty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Spot&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> savedKitty <span class="token operator">=</span> <span class="token keyword">await</span> kitty<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>savedKitty<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> says 'meow'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>mongoose.model</code> method is a class factory that creates a resource class that represents a document collection and we can use it to interact with the database. In the example above we are giving it two properties: <code>'Cat'</code> is the name of the class of objects to store in a collection in the database, and <code>{name: String}</code> is the expected shape of each <code>'Cat'</code> document - it will have a property called 'name' which will hold some string data.</p> <p><strong>An instance of a Model is a Mongoose Document.</strong>
Use the <code>new</code> keyword with the model class to create a new instance, or new database document from that class.</p> <blockquote><p>Naming conventions: Models are named as a singular noun and start with a capital letter. Database tables or document collections are named as the plural of the model name and are all lower case.</p></blockquote> <p>OK. Lets run it and then check the results in MongoDB Compass.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>node mongooseTest<span class="token punctuation">.</span>js
</code></pre></div><p>Let's try adding another Cat instance to the collection. Change the name on line three and rerun it.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Cat <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> kitty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Patches&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> savedKitty <span class="token operator">=</span> <span class="token keyword">await</span> kitty<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>savedKitty<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> says 'meow'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Let's try adding an age to our next Cat.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Cat <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> kitty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Callie&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> savedKitty <span class="token operator">=</span> <span class="token keyword">await</span> kitty<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>savedKitty<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> says 'meow'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This time, when we check it in Compass the age was not saved. Our Mongoose Model automatically discards any properties that are not predefined. This time change the model schema as well.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Cat <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> kitty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Callie&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> savedKitty <span class="token operator">=</span> <span class="token keyword">await</span> kitty<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>savedKitty<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> says 'meow'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>We can also insert many objects into the database at once.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Cat <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> newCats <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Fluffy&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Pink Spots&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Tabatha&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">16</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> docs <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span>newCats<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>We have added many documents to our collection. How do we retrieve them? Add a new line to find all of the cats from the database.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> cats <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cats <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>How about listing just the Cats with the name 'Spot'?</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> catsNamedSpot <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Spot&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> catsNamedSpot <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>That found all of the cats with the exact name 'Spot'. But, what if we wanted to check for names like Spot? We can use regular expressions (opens new window)to match patterns. Replace the quotes with slashes. Now it will match 'Spot', 'Spots', 'Spotty', or 'Pink Spots'.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> catsNamedSpotRegexp <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Spot</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> catsNamedSpotRegexp <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Regular expressions can be a very powerful tool. Checkout the resources linked below to learn more.</p> <p>Putting it all together, the final version of our mongooseTest.js should look like this.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>use strict&quot;<span class="token punctuation">;</span>

<span class="token comment">// Import the Mongoose library</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Connect the mongoose instance to our MongoDB</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;mongodb://localhost:27017/test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'connected to mongodb'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Error connecting to mongodb: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Define the document model for the 'cats' collection</span>
<span class="token keyword">const</span> Cat <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create a new Cat document and save it to the database</span>
    <span class="token keyword">const</span> kitty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Callie&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> savedKitty <span class="token operator">=</span> <span class="token keyword">await</span> kitty<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>savedKitty<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> says 'meow'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Directly insert an array of Cat property objects</span>
    <span class="token keyword">const</span> newCats <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Fluffy&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Pink Spots&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Tabatha&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">16</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> docs <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span>newCats<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// List all of the Cats in the collection</span>
    <span class="token keyword">const</span> catsNamedSpot <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Spot&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> catsNamedSpot <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// List only the Cats with 'Spot' in the name</span>
    <span class="token keyword">const</span> catsNamedSpotRegexp <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Spot</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> catsNamedSpotRegexp <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>There is a lot more to learn about how to use Mongoose and we will continue next week.</p> <h2 id="mongodb-vs-mongodb-atlas-what-are-the-differences"><a href="#mongodb-vs-mongodb-atlas-what-are-the-differences" class="header-anchor">#</a> MongoDB vs MongoDB Atlas: What are the differences?</h2> <p>MongoDB and MongoDB Atlas are related, but they are not the same thing. Here are some of the key differences between MongoDB and MongoDB Atlas:</p> <ul><li><p>Deployment: MongoDB is a self-hosted database that can be installed on-premises or in the cloud, while MongoDB Atlas is a fully managed cloud-based database service provided by MongoDB Inc.</p></li> <li><p>Management: With MongoDB, you are responsible for managing and maintaining your database infrastructure, including hardware provisioning, software updates, security, and backups. With MongoDB Atlas, these tasks are handled by MongoDB Inc., allowing you to focus on building and managing your applications.</p></li> <li><p>Scalability: MongoDB can be scaled horizontally by adding more servers to the cluster, but this requires manual configuration and management. With MongoDB Atlas, scaling is automatic and can be done with a few clicks.</p></li> <li><p>Availability: MongoDB can be configured for high availability using replica sets, but this also requires manual configuration and management. With MongoDB Atlas, high availability is built-in and automatically managed by MongoDB Inc.</p></li> <li><p>Security: Both MongoDB and MongoDB Atlas provide robust security features, including authentication, encryption, and access controls. However, with MongoDB Atlas, MongoDB Inc. takes care of security updates and patches, ensuring that your database is always secure.</p></li></ul> <p>In summary, MongoDB is a self-hosted database that requires manual management and configuration, while MongoDB Atlas is a fully managed cloud-based database service that takes care of the management and maintenance of your database infrastructure.</p> <h2 id="exercise-set-up-mongodb"><a href="#exercise-set-up-mongodb" class="header-anchor">#</a> Exercise: Set-up MongoDB</h2> <p>Submit a screenshot of MongoDB Compass showing the connection to localhost:27017/test.cats and the listing of the documents in the collection after your test transactions.</p> <p><img src="/s2024/assets/img/compass_4.aeb65190.png" alt="MongoDB Local"></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/6/2024, 10:27:57 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/s2024/modules/break-week/" class="prev">
        Break Week
      </a></span> <span class="next"><a href="/s2024/modules/week10/">
        Week 10: Object Data Modelling with Mongoose
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/s2024/assets/js/app.40d35fb0.js" defer></script><script src="/s2024/assets/js/2.d13f26af.js" defer></script><script src="/s2024/assets/js/1.f6f71081.js" defer></script><script src="/s2024/assets/js/26.de8d994d.js" defer></script><script src="/s2024/assets/js/32.baab7363.js" defer></script>
  </body>
</html>
